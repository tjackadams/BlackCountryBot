variables:
  registryEndpoint: eblackcountry-registry
  DOCKER_BUILDKIT: 1
trigger:
  branches:
    include:
    - master
  paths:
    include:
      - src/BuildingBlocks/*
      - src/Services/Bot/*
      - deploy/k8s/helm/bot-api/*
jobs:
  - template: ../buildimages.yaml
    parameters:
      services: bot-api
      registryEndpoint: $(registryEndpoint)
      helmfrom: $(Build.SourcesDirectory)/deploy/k8s/helm
      helmto: $(Build.ArtifactStagingDirectory)/deploy/k8s/helm
  - template: ../multiarch.yaml
    parameters:
      image: bot.api
      branch: $(Build.SourceBranchName)
      registryEndpoint: $(registryEndpoint)